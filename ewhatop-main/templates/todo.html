<!DOCTYPE html>
<html lang = "ko">
<head>
    <meta charset="UTF-8">
    <title>체크리스트</title>
    <link rel="stylesheet" href="/static/todo-style.css" />
    <style>
    .main-sections {
      display: flex;
      justify-content: space-between;
      padding: 0 60px;
    }
    .prev-todo-section {
      margin-left: 20px;
    }
    .prev-todo-list li {
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div class="todo-container">
    <!-- 로그아웃 버튼-->
    <div class="icon logout-icon"></div>
      <form action="{{ url_for('logout') }}" method="get" style="display:inline;">
        <button type="submit" style="cursor:pointer;">로그아웃</button>
      </form>
    </div>

  <div class="main-sections">
    <div class="todo-list-section">
      <h2 class="section-title todo-title">할 일 목록</h2>
      <div class="date"></div>

    <ol class="todo-list">
      <!-- 할 일 목록이 반복문으로 들어가는 자리 -->
      {% for t in todos_today %}
        <li>
          <label class="todo-item">
            <span>{{ t.task }}</span>
            <input type="checkbox" id="todo{{ t.id }}">
          </label>
        </li>
      {% endfor %}
    </ol>

    <!-- 할 일 추가 버튼-->
    <form action="/add_todo" method="post" style="margin-top: 20px;">
      <input type="text" name="task" placeholder="할 일을 입력하세요" required>
      <button type="submit">+ 할 일 추가</button>
    </form>
  </div>
  
  <!-- 전에 못한 일 제목 위에 검정 구분선 -->
  <hr class="section-divider black-divider">

  <!-- 오른쪽: 전에 못한 일 -->
  <div class="prev-todo-section">
    <h2 class="section-title prev-title">전에 못한 일</h2>
    <ul class="prev-todo-list">
      
      {% for todo in prev_todos %}
      <li>
        <input type="checkbox" id="prev{{ loop.index }}">
        <label for="prev{{ loop.index }}">
          ({{ todo.due_date.strftime('%Y.%m.%d') }}) {{ todo.task }}
        </label>
      </li>
      {% endfor %}
    
    </ul>
  </div>
</div> <!-- :흰색_확인_표시: main-sections 끝 -->
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const addButton = document.querySelector(".add-todo");
    const inputBox = document.querySelector(".add-task-box");
    const todoList = document.querySelector(".todo-list");
    const dateDiv = document.querySelector(".date");
    // 오늘 날짜 한국어로 표시
    const today = new Date().toLocaleDateString("ko-KR", {
      year: "numeric",
      month: "long",
      day: "numeric",
      weekday: "long"
    });
    dateDiv.textContent = today;
    // 할 일 추가 버튼 클릭 이벤트
    addButton.addEventListener("click", function () {
      const task = inputBox.value.trim();
      // 입력창이 보이지 않으면 보여주기
      if (inputBox.offsetParent === null) {
        inputBox.style.display = "inline-block";
        inputBox.focus();
        return;
      }
      // 입력값이 있을 경우, 새로운 할 일 추가
      if (task !== "") {
        const newTodo = document.createElement("li");
        const newId = "todo" + Date.now();
        newTodo.innerHTML = `
          <label class="todo-item">
            <span>${task}</span>
            <input type="checkbox" id="${newId}">
          </label>
        `;
        todoList.appendChild(newTodo);
        // 입력창 초기화 및 숨기기
        inputBox.value = "";
        inputBox.style.display = "none";
      }
    });
  });
</script>
</body>
</html>
